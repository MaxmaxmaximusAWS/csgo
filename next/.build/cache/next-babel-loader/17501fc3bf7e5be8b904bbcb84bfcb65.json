{"ast":null,"code":"var _s=$RefreshSig$(),_s2=$RefreshSig$();import{useQuery,useSubscription}from\"@apollo/react-hooks\";export default function useLiveQuery(query){_s();var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(!true){return useQuery(query,options);}return useLiveQueryBrowser(query,options);}_s(useLiveQuery,\"SkN6E8ACd/H2ljrN3AHVEfbgj28=\",false,function(){return[useQuery,useLiveQueryBrowser];});var subscriptionsMap=new WeakMap();function useLiveQueryBrowser(query,options){_s2();if(!subscriptionsMap.has(query)){subscriptionsMap.set(query,createSubscription(query));}var subscription=subscriptionsMap.get(query);var queryResult=useQuery(query,options);useSubscription(subscription,{onSubscriptionData:function onSubscriptionData(_ref){var client=_ref.client,data=_ref.subscriptionData.data;client.writeQuery({query:query,data:data,variables:options.variables});}});return queryResult;}_s2(useLiveQueryBrowser,\"BvCwRLG/i5V6RS+lk6Gtf+Mxjqk=\",false,function(){return[useQuery,useSubscription];});function createSubscription(query){var subscription=JSON.parse(JSON.stringify(query));subscription.definitions[0].operation='subscription';return subscription;}","map":{"version":3,"sources":["/app/next/lib/useLiveQuery.js"],"names":["useQuery","useSubscription","useLiveQuery","query","options","useLiveQueryBrowser","subscriptionsMap","WeakMap","has","set","createSubscription","subscription","get","queryResult","onSubscriptionData","client","data","subscriptionData","writeQuery","variables","JSON","parse","stringify","definitions","operation"],"mappings":"yCAAA,OAASA,QAAT,CAAmBC,eAAnB,KAA0C,qBAA1C,CAIA,cAAe,SAASC,CAAAA,YAAT,CAAsBC,KAAtB,CAA2C,SAAdC,CAAAA,OAAc,2DAAJ,EAAI,CACxD,GAAI,KAAJ,CAAsB,CACpB,MAAOJ,CAAAA,QAAQ,CAACG,KAAD,CAAQC,OAAR,CAAf,CACD,CAED,MAAOC,CAAAA,mBAAmB,CAACF,KAAD,CAAQC,OAAR,CAA1B,CACD,C,GANuBF,Y,wDAEbF,Q,CAGFK,mB,KAIT,GAAMC,CAAAA,gBAAgB,CAAG,GAAIC,CAAAA,OAAJ,EAAzB,CAEA,QAASF,CAAAA,mBAAT,CAA6BF,KAA7B,CAAoCC,OAApC,CAA6C,OAC3C,GAAI,CAACE,gBAAgB,CAACE,GAAjB,CAAqBL,KAArB,CAAL,CAAkC,CAChCG,gBAAgB,CAACG,GAAjB,CAAqBN,KAArB,CAA4BO,kBAAkB,CAACP,KAAD,CAA9C,EACD,CAED,GAAMQ,CAAAA,YAAY,CAAGL,gBAAgB,CAACM,GAAjB,CAAqBT,KAArB,CAArB,CAEA,GAAMU,CAAAA,WAAW,CAAGb,QAAQ,CAACG,KAAD,CAAQC,OAAR,CAA5B,CAEAH,eAAe,CAACU,YAAD,CAAe,CAC5BG,kBAD4B,kCAC2B,IAAnCC,CAAAA,MAAmC,MAAnCA,MAAmC,CAARC,IAAQ,MAA3BC,gBAA2B,CAARD,IAAQ,CACrDD,MAAM,CAACG,UAAP,CAAkB,CAChBf,KAAK,CAALA,KADgB,CACTa,IAAI,CAAJA,IADS,CAEhBG,SAAS,CAAEf,OAAO,CAACe,SAFH,CAAlB,EAID,CAN2B,CAAf,CAAf,CASA,MAAON,CAAAA,WAAP,CACD,C,IAnBQR,mB,wDAOaL,Q,CAEpBC,e,KAaF,QAASS,CAAAA,kBAAT,CAA4BP,KAA5B,CAAmC,CACjC,GAAIQ,CAAAA,YAAY,CAAGS,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAenB,KAAf,CAAX,CAAnB,CACAQ,YAAY,CAACY,WAAb,CAAyB,CAAzB,EAA4BC,SAA5B,CAAwC,cAAxC,CACA,MAAOb,CAAAA,YAAP,CACD","sourcesContent":["import { useQuery, useSubscription } from \"@apollo/react-hooks\"\r\nimport gql from \"graphql-tag\"\r\n\r\n\r\nexport default function useLiveQuery(query, options = {}) {\r\n  if (!process.browser) {\r\n    return useQuery(query, options)\r\n  }\r\n\r\n  return useLiveQueryBrowser(query, options)\r\n}\r\n\r\n\r\nconst subscriptionsMap = new WeakMap()\r\n\r\nfunction useLiveQueryBrowser(query, options) {\r\n  if (!subscriptionsMap.has(query)) {\r\n    subscriptionsMap.set(query, createSubscription(query))\r\n  }\r\n\r\n  const subscription = subscriptionsMap.get(query)\r\n\r\n  const queryResult = useQuery(query, options)\r\n\r\n  useSubscription(subscription, {\r\n    onSubscriptionData({client, subscriptionData: {data}}) {\r\n      client.writeQuery({\r\n        query, data,\r\n        variables: options.variables\r\n      })\r\n    }\r\n  })\r\n\r\n  return queryResult\r\n}\r\n\r\n\r\nfunction createSubscription(query) {\r\n  let subscription = JSON.parse(JSON.stringify(query))\r\n  subscription.definitions[0].operation = 'subscription'\r\n  return subscription\r\n}\r\n"]},"metadata":{},"sourceType":"module"}