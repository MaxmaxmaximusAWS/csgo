{"ast":null,"code":"import _slicedToArray from\"@babel/runtime/helpers/esm/slicedToArray\";var _jsxFileName=\"C:\\\\localhost\\\\csshot\\\\web\\\\components\\\\RefsPage\\\\RefsPage.js\",_s=$RefreshSig$(),_s2=$RefreshSig$();import React from\"react\";var __jsx=React.createElement;import Page from\"../Widgets/Page\";import{useState}from\"react\";import Button from\"../Widgets/Button\";import{useQuery,useSubscription,useMutation,useApolloClient}from'@apollo/react-hooks';function useLiveQuery(query){}var GET_MESSAGES_SUB={\"kind\":\"Document\",\"definitions\":[{\"kind\":\"OperationDefinition\",\"operation\":\"subscription\",\"variableDefinitions\":[],\"directives\":[],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"message\"},\"arguments\":[],\"directives\":[],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"id\"},\"arguments\":[],\"directives\":[]},{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"text\"},\"arguments\":[],\"directives\":[]}]}}]}}],\"loc\":{\"start\":0,\"end\":62,\"source\":{\"body\":\"\\n  subscription {\\n    message {\\n      id\\n      text\\n    }\\n  }\\n\",\"name\":\"GraphQL request\",\"locationOffset\":{\"line\":1,\"column\":1}}}};var DELETE_MESSAGE={\"kind\":\"Document\",\"definitions\":[{\"kind\":\"OperationDefinition\",\"operation\":\"mutation\",\"variableDefinitions\":[{\"kind\":\"VariableDefinition\",\"variable\":{\"kind\":\"Variable\",\"name\":{\"kind\":\"Name\",\"value\":\"id\"}},\"type\":{\"kind\":\"NonNullType\",\"type\":{\"kind\":\"NamedType\",\"name\":{\"kind\":\"Name\",\"value\":\"Int\"}}},\"directives\":[]}],\"directives\":[],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"delete_message_by_pk\"},\"arguments\":[{\"kind\":\"Argument\",\"name\":{\"kind\":\"Name\",\"value\":\"id\"},\"value\":{\"kind\":\"Variable\",\"name\":{\"kind\":\"Name\",\"value\":\"id\"}}}],\"directives\":[],\"selectionSet\":{\"kind\":\"SelectionSet\",\"selections\":[{\"kind\":\"Field\",\"name\":{\"kind\":\"Name\",\"value\":\"__typename\"},\"arguments\":[],\"directives\":[]}]}}]}}],\"loc\":{\"start\":0,\"end\":89,\"source\":{\"body\":\"\\n  mutation ($id: Int!) {\\n    delete_message_by_pk(id: $id) {\\n      __typename\\n    }\\n  }\\n\",\"name\":\"GraphQL request\",\"locationOffset\":{\"line\":1,\"column\":1}}}};function MessageInput(){function onSubmit(input){console.log(input);}return __jsx(\"input\",{type:\"text\",onKeyPress:onSubmit,__self:this,__source:{fileName:_jsxFileName,lineNumber:38,columnNumber:10}});}_c=MessageInput;function DeleteButton(_ref){_s();var id=_ref.id;var _useMutation=useMutation(DELETE_MESSAGE),_useMutation2=_slicedToArray(_useMutation,2),deleteMessage=_useMutation2[0],status=_useMutation2[1];function onClick(){deleteMessage({variables:{id:id}});}return __jsx(Button,{onClick:onClick,__self:this,__source:{fileName:_jsxFileName,lineNumber:49,columnNumber:10}},\"Delete \",id);}_s(DeleteButton,\"h5djlls4NwrNbhWcgdapITuGpNg=\",false,function(){return[useMutation];});_c2=DeleteButton;function DemoChat(){_s2();var _this=this;var _useSubscription=useSubscription(GET_MESSAGES_SUB),loading=_useSubscription.loading,error=_useSubscription.error,data=_useSubscription.data;if(loading)return __jsx(\"div\",{__self:this,__source:{fileName:_jsxFileName,lineNumber:55,columnNumber:23}},\"Loading...\");if(error)return __jsx(\"div\",{__self:this,__source:{fileName:_jsxFileName,lineNumber:56,columnNumber:21}},\"Error \",error.message,\"...\");return __jsx(\"div\",{__self:this,__source:{fileName:_jsxFileName,lineNumber:58,columnNumber:10}},__jsx(MessageInput,{__self:this,__source:{fileName:_jsxFileName,lineNumber:59,columnNumber:5}}),__jsx(\"ul\",{__self:this,__source:{fileName:_jsxFileName,lineNumber:61,columnNumber:5}},data.message.map(function(message){return __jsx(\"li\",{key:message.id,__self:_this,__source:{fileName:_jsxFileName,lineNumber:63,columnNumber:9}},__jsx(DeleteButton,{id:message.id,__self:_this,__source:{fileName:_jsxFileName,lineNumber:64,columnNumber:11}}),message.text);})));}_s2(DemoChat,\"/1S3YKT8omEIMka7T2yVafmpBuI=\",false,function(){return[useSubscription];});_c3=DemoChat;export default function RefsPage(){return __jsx(Page,{__self:this,__source:{fileName:_jsxFileName,lineNumber:75,columnNumber:10}},__jsx(DemoChat,{__self:this,__source:{fileName:_jsxFileName,lineNumber:76,columnNumber:5}}));}_c4=RefsPage;var _c,_c2,_c3,_c4;$RefreshReg$(_c,\"MessageInput\");$RefreshReg$(_c2,\"DeleteButton\");$RefreshReg$(_c3,\"DemoChat\");$RefreshReg$(_c4,\"RefsPage\");","map":{"version":3,"sources":["C:/localhost/csshot/web/components/RefsPage/RefsPage.js"],"names":["Page","useState","Button","useQuery","useSubscription","useMutation","useApolloClient","useLiveQuery","query","GET_MESSAGES_SUB","DELETE_MESSAGE","MessageInput","onSubmit","input","console","log","DeleteButton","id","deleteMessage","status","onClick","variables","DemoChat","loading","error","data","message","map","text","RefsPage"],"mappings":"gPACA,MAAOA,CAAAA,IAAP,KAAiB,iBAAjB,CACA,OAASC,QAAT,KAAyB,OAAzB,CACA,MAAOC,CAAAA,MAAP,KAAmB,mBAAnB,CAGA,OACEC,QADF,CACYC,eADZ,CAC6BC,WAD7B,CAC0CC,eAD1C,KAEO,qBAFP,CAKA,QAASC,CAAAA,YAAT,CAAsBC,KAAtB,CAA6B,CAE5B,CAED,GAAMC,CAAAA,gBAAgB,2qBAAtB,CASA,GAAMC,CAAAA,cAAc,s8BAApB,CAQA,QAASC,CAAAA,YAAT,EAAwB,CACtB,QAASC,CAAAA,QAAT,CAAkBC,KAAlB,CAAyB,CACvBC,OAAO,CAACC,GAAR,CAAYF,KAAZ,EACD,CAED,MAAO,gBAAO,IAAI,CAAC,MAAZ,CAAmB,UAAU,CAAGD,QAAhC,6EAAP,CACD,C,GANQD,Y,CAST,QAASK,CAAAA,YAAT,MAA4B,SAALC,CAAAA,EAAK,MAALA,EAAK,kBACMZ,WAAW,CAACK,cAAD,CADjB,8CACnBQ,aADmB,kBACJC,MADI,kBAG1B,QAASC,CAAAA,OAAT,EAAmB,CACjBF,aAAa,CAAC,CAACG,SAAS,CAAE,CAACJ,EAAE,CAAFA,EAAD,CAAZ,CAAD,CAAb,CACD,CAED,MAAO,OAAC,MAAD,EAAQ,OAAO,CAAGG,OAAlB,uFAAqCH,EAArC,CAAP,CACD,C,GARQD,Y,wDACyBX,W,SADzBW,Y,CAWT,QAASM,CAAAA,QAAT,EAAoB,2CACalB,eAAe,CAACK,gBAAD,CAD5B,CACXc,OADW,kBACXA,OADW,CACFC,KADE,kBACFA,KADE,CACKC,IADL,kBACKA,IADL,CAElB,GAAIF,OAAJ,CAAa,MAAO,uGAAP,CACb,GAAIC,KAAJ,CAAW,MAAO,mGAAaA,KAAK,CAACE,OAAnB,OAAP,CAEX,MAAO,0FACL,MAAC,YAAD,6EADK,CAGL,uFACID,IAAI,CAACC,OAAL,CAAaC,GAAb,CAAiB,SAAAD,OAAO,QACxB,aAAI,GAAG,CAAGA,OAAO,CAACT,EAAlB,6EACE,MAAC,YAAD,EAAc,EAAE,CAAGS,OAAO,CAACT,EAA3B,8EADF,CAEIS,OAAO,CAACE,IAFZ,CADwB,EAAxB,CADJ,CAHK,CAAP,CAYD,C,IAjBQN,Q,wDACwBlB,e,SADxBkB,Q,CAmBT,cAAe,SAASO,CAAAA,QAAT,EAAoB,CAGjC,MAAO,OAAC,IAAD,8EACL,MAAC,QAAD,6EADK,CAAP,CAGD,C,IANuBA,Q","sourcesContent":["import css from 'styled-jsx/css'\r\nimport Page from \"../Widgets/Page\"\r\nimport { useState } from \"react\"\r\nimport Button from \"../Widgets/Button\"\r\nimport gql from 'graphql-tag'\r\n\r\nimport {\r\n  useQuery, useSubscription, useMutation, useApolloClient\r\n} from '@apollo/react-hooks'\r\n\r\n\r\nfunction useLiveQuery(query) {\r\n\r\n}\r\n\r\nconst GET_MESSAGES_SUB = gql`\r\n  subscription {\r\n    message {\r\n      id\r\n      text\r\n    }\r\n  }\r\n`\r\n\r\nconst DELETE_MESSAGE = gql`\r\n  mutation ($id: Int!) {\r\n    delete_message_by_pk(id: $id) {\r\n      __typename\r\n    }\r\n  }\r\n`\r\n\r\nfunction MessageInput() {\r\n  function onSubmit(input) {\r\n    console.log(input)\r\n  }\r\n  \r\n  return <input type=\"text\" onKeyPress={ onSubmit }/>\r\n}\r\n\r\n\r\nfunction DeleteButton({id}) {\r\n  const [deleteMessage, status] = useMutation(DELETE_MESSAGE)\r\n\r\n  function onClick() {\r\n    deleteMessage({variables: {id}})\r\n  }\r\n\r\n  return <Button onClick={ onClick }>Delete { id }</Button>\r\n}\r\n\r\n\r\nfunction DemoChat() {\r\n  const {loading, error, data} = useSubscription(GET_MESSAGES_SUB)\r\n  if (loading) return <div>Loading...</div>\r\n  if (error) return <div>Error { error.message }...</div>\r\n\r\n  return <div>\r\n    <MessageInput/>\r\n\r\n    <ul>\r\n      { data.message.map(message => (\r\n        <li key={ message.id }>\r\n          <DeleteButton id={ message.id }/>\r\n          { message.text }\r\n        </li>\r\n      )) }\r\n    </ul>\r\n  </div>\r\n}\r\n\r\nexport default function RefsPage() {\r\n\r\n\r\n  return <Page>\r\n    <DemoChat/>\r\n  </Page>\r\n}\r\n\r\n\r\n"]},"metadata":{},"sourceType":"module"}
